{# Leaf tenant IGMP snooping #}
{% set igmp_snooping = namespace() %}
{% set igmp_snooping.configured = false %}
{% for tenant in tenants | arista.avd.natural_sort if tenant in leaf.filter_tenants or "all" in leaf.filter_tenants %}
{%     if tenants[tenant].vrfs is defined %}
{%         for vrf in tenants[tenant].vrfs | arista.avd.natural_sort if leaf.vrfs is not none and vrf in leaf.vrfs %}
{%             for svi in tenants[tenant].vrfs[vrf].svis | arista.avd.natural_sort if leaf.svis is not none and svi in leaf.svis %}
{%                  if tenants[tenant].vrfs[vrf].svis[svi].ip_igmp_snooping is defined %}
{%                      set igmp_snooping.configured = true %}
{%                  endif %}
{%             endfor %}
{%         endfor %}
{%     endif %}
{% endfor %}
{% if igmp_snooping.configured == true %}
  vlans:
{%      for tenant in tenants | arista.avd.natural_sort if tenant in leaf.filter_tenants or "all" in leaf.filter_tenants %}
## {{ tenant }} ##
{%          if tenants[tenant].vrfs is defined %}
{%              for vrf in tenants[tenant].vrfs | arista.avd.natural_sort if leaf.vrfs is not none and vrf in leaf.vrfs %}
{# Tenant VLANs w/SVIs #}
{%                  for svi in tenants[tenant].vrfs[vrf].svis | arista.avd.natural_sort if leaf.svis is not none and svi in leaf.svis %}
{%                      if tenants[tenant].vrfs[vrf].svis[svi].ip_igmp_snooping is not defined %}
    {{ svi|int }}:
      enabled: true
{%                      elif tenants[tenant].vrfs[vrf].svis[svi].ip_igmp_snooping == true %}
    {{ svi|int }}:
      enabled: true
{%                      elif tenants[tenant].vrfs[vrf].svis[svi].ip_igmp_snooping == false %}
    {{ svi|int }}:
      enabled: false
{%                      endif %}
{%                  endfor %}
{%              endfor %}
{%          endif %}
{%      endfor %}
{% endif %}
