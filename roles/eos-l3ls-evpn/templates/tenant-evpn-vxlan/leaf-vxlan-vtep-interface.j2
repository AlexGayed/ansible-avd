{# vxlan-vtep interface #}
  Vxlan1:
    description: {{ inventory_hostname }}_VTEP
    source_interface: Loopback1
{% if leaf.mlag == true %}
    virtual_router:
      encapsulation_mac_address: "mlag-system-id"
{% endif %}
    vxlan_udp_port: 4789
    vxlan_vni_mappings:
      vlans:
{% for tenant in tenants | natural_sort if tenant in leaf.filter_tenants or "all" in leaf.filter_tenants %}
## {{ tenant }} ##
{%     if tenants[tenant].vrfs is defined %}
{%         for vrf in tenants[tenant].vrfs | natural_sort if vrf in leaf.vrfs %}
{%             for svi in tenants[tenant].vrfs[vrf].svis | natural_sort if svi in leaf.svis %}
        {{ svi }}:
          vni: {{ vxlan_vni_base * tenants[tenant].id + svi }}
{%             endfor %}
{%         endfor %}
{%     endif %}
{%     if tenants[tenant].l2vlans is defined %}
{%         for l2vlan in tenants[tenant].l2vlans | natural_sort if l2vlan in leaf.vlans %}
        {{ l2vlan }}:
          vni: {{ vxlan_vni_base * tenants[tenant].id + l2vlan }}
{%         endfor %}
{%     endif %}
{% endfor %}
      vrfs:
{% for tenant in tenants | natural_sort if tenant in leaf.filter_tenants or "all" in leaf.filter_tenants %}
## {{ tenant }} ##
{%     if tenants[tenant].vrfs is defined %}
{%         for vrf in tenants[tenant].vrfs | natural_sort if vrf in leaf.vrfs %}
        {{ vrf }}:
          vni: {{ vxlan_vni_base * tenants[tenant].id + 5000 + tenants[tenant].vrfs[vrf].id  }}
{%         endfor %}
{%     endif %}
{% endfor %}